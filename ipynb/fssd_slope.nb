(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     26464,        764]
NotebookOptionsPosition[     24266,        697]
NotebookOutlinePosition[     24631,        713]
CellTagsIndexPosition[     24588,        710]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Slope of FSSD", "Section",
 CellChangeTimes->{{3.7012499217748747`*^9, 3.7012499288245792`*^9}}],

Cell["Will assume Gaussian p,q and a Gaussian kernel.", "Text",
 CellChangeTimes->{{3.701249929644205*^9, 3.70124996129904*^9}}],

Cell[BoxData[{
 RowBox[{
  SubscriptBox["\[Mu]", "p"], "=", "0"}], "\[IndentingNewLine]", 
 RowBox[{
  SubscriptBox["\[Sigma]", "p"], "=", "1"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"logp", "[", "x_", "]"}], ":=", 
  RowBox[{
   RowBox[{"-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"x", "-", 
       SubscriptBox["\[Mu]", "p"]}], ")"}], "^", "2"}]}], "/", 
   RowBox[{"(", 
    RowBox[{"2", "*", 
     SuperscriptBox[
      SubscriptBox["\[Sigma]", "p"], "2"]}], ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ker", "[", 
   RowBox[{"x_", ",", "y_", ",", "s_"}], "]"}], ":=", 
  RowBox[{"Exp", "[", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"x", "-", "y"}], ")"}], "^", "2"}]}], "/", 
    RowBox[{"(", 
     RowBox[{"2", "*", "s"}], ")"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Dkx", "[", 
   RowBox[{"x_", ",", "y_", ",", "s_"}], "]"}], ":=", 
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"ker", "[", 
     RowBox[{"x", ",", "y", ",", "s"}], "]"}], ",", "x"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Dky", "[", 
   RowBox[{"x_", ",", "y_", ",", "s_"}], "]"}], ":=", 
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"ker", "[", 
     RowBox[{"x", ",", "y", ",", "s"}], "]"}], ",", "y"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Dkxy", "[", 
   RowBox[{"x_", ",", "y_", ",", "s_"}], "]"}], ":=", 
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"Dkx", "[", 
     RowBox[{"x", ",", "y", ",", "s"}], "]"}], ",", "y"}], "]"}]}]}], "Input",\

 CellChangeTimes->{{3.701250983363731*^9, 3.701251036012233*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"xi", "[", 
   RowBox[{"x_", ",", "v_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"logp", "'"}], "[", "x", "]"}], "*", 
    RowBox[{"ker", "[", 
     RowBox[{"x", ",", "v", ",", 
      SuperscriptBox[
       SubscriptBox["\[Sigma]", "k"], "2"]}], "]"}]}], "+", 
   RowBox[{"Dkx", "[", 
    RowBox[{"x", ",", "v", ",", 
     SuperscriptBox[
      SubscriptBox["\[Sigma]", "k"], "2"]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.701250136920866*^9, 3.7012502087968273`*^9}, {
  3.70125033528378*^9, 3.701250379027025*^9}, {3.701250615030216*^9, 
  3.701250650628673*^9}, {3.701250744740963*^9, 3.70125075805263*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"xi", "[", 
   RowBox[{"x", ",", "v"}], "]"}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.701250733911092*^9, 3.701250736139641*^9}, {
  3.702037442608626*^9, 3.702037444256*^9}}],

Cell[BoxData[
 RowBox[{"exi", "=", 
  RowBox[{"Expectation", "[", 
   RowBox[{
    RowBox[{"xi", "[", 
     RowBox[{"x", ",", "v"}], "]"}], ",", 
    RowBox[{"x", "\[Distributed]", 
     RowBox[{"NormalDistribution", "[", 
      RowBox[{
       SubscriptBox["\[Mu]", "q"], ",", 
       SubscriptBox["\[Sigma]", "q"]}], "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7012502287456503`*^9, 3.701250264458084*^9}, {
  3.701250355770729*^9, 3.701250385006822*^9}, {3.701250815227276*^9, 
  3.701250816126905*^9}}],

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{"exi", "/.", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["\[Mu]", "q"], "\[Rule]", "0"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7012518990647593`*^9, 3.7012519212762938`*^9}}],

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{"exi", "/.", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["\[Sigma]", "q"], "\[Rule]", "1"}], "}"}]}], "]"}]], "Input",\

 CellChangeTimes->{{3.701251928909128*^9, 3.70125193941336*^9}}],

Cell[BoxData[
 RowBox[{"fssd2", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{"exi", "^", "2"}], "]"}]}]], "Input",
 CellChangeTimes->{
  3.701250411123252*^9, {3.701250602704472*^9, 3.701250624241933*^9}, {
   3.701250820978918*^9, 3.701250830976215*^9}, {3.7012508637393103`*^9, 
   3.701250866438568*^9}}],

Cell[BoxData[
 RowBox[{"exi2", " ", "=", " ", 
  RowBox[{"Assuming", "[", 
   RowBox[{
    RowBox[{
     SubscriptBox["\[Sigma]", "k"], ">", "0"}], ",", 
    RowBox[{"Expectation", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"xi", "[", 
        RowBox[{"x", ",", "v"}], "]"}], "^", "2"}], ",", 
      RowBox[{"x", "\[Distributed]", 
       RowBox[{"NormalDistribution", "[", 
        RowBox[{
         SubscriptBox["\[Mu]", "p"], ",", 
         SubscriptBox["\[Sigma]", "p"]}], "]"}]}]}], "]"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.7012509186423893`*^9, 3.701250954225236*^9}, {
  3.701251065575253*^9, 3.701251069636429*^9}, {3.7020222773467216`*^9, 
  3.7020222840363617`*^9}}],

Cell[BoxData[
 RowBox[{"vxip", " ", "=", " ", 
  RowBox[{"Simplify", "[", "exi2", "]"}]}]], "Input",
 CellChangeTimes->{{3.7012511294791613`*^9, 3.701251161063117*^9}, 
   3.701251207822625*^9, 3.7012522062477417`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"f$vxip", "[", 
   RowBox[{"v1_", ",", "sq1_", ",", "sk1_"}], "]"}], ":=", 
  RowBox[{"vxip", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "\[Rule]", "v1"}], ",", 
     RowBox[{
      SubscriptBox["\[Sigma]", "q"], "\[Rule]", 
      RowBox[{"Sqrt", "[", "sq1", "]"}]}], ",", 
     RowBox[{
      SubscriptBox["\[Sigma]", "k"], "\[Rule]", 
      RowBox[{"Sqrt", "[", "sk1", "]"}]}]}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.7019397169974117`*^9, 3.701939786870491*^9}}],

Cell[BoxData[
 RowBox[{"e2xi", "=", 
  RowBox[{
   RowBox[{"Assuming", "[", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[Sigma]", "k"], ">", "0"}], ",", 
     RowBox[{"exi", "^", "2"}]}], "]"}], "//", "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.701252282210189*^9, 3.701252286421579*^9}, {
  3.701664015972657*^9, 3.701664019607658*^9}, {3.7020223099569483`*^9, 
  3.702022315344589*^9}}],

Cell[BoxData[
 RowBox[{"slope$fssd", " ", "=", " ", 
  RowBox[{"(", 
   RowBox[{"e2xi", "/", "vxip"}], ")"}]}]], "Input",
 CellChangeTimes->{{3.701251240904748*^9, 3.701251242183652*^9}, {
   3.70125133367083*^9, 3.701251349682724*^9}, {3.701251475244825*^9, 
   3.701251478293509*^9}, {3.7012522927472687`*^9, 3.701252293609235*^9}, {
   3.701267210899046*^9, 3.701267217971405*^9}, {3.701334215804434*^9, 
   3.701334252054089*^9}, {3.701334288766481*^9, 3.701334352816421*^9}, 
   3.7013344094775887`*^9, {3.70133445365455*^9, 3.701334474613871*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"f$slope$fssd", "[", 
   RowBox[{"v1_", ",", "mq1_", ",", "sq1_", ",", "sk1_"}], "]"}], ":=", 
  RowBox[{"slope$fssd", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "\[Rule]", "v1"}], ",", 
     RowBox[{
      SubscriptBox["\[Mu]", "q"], "\[Rule]", "mq1"}], ",", 
     RowBox[{
      SubscriptBox["\[Sigma]", "q"], "\[Rule]", 
      RowBox[{"Sqrt", "[", "sq1", "]"}]}], ",", 
     RowBox[{
      SubscriptBox["\[Sigma]", "k"], "\[Rule]", 
      RowBox[{"Sqrt", "[", "sk1", "]"}]}]}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.701334478805183*^9, 3.7013345263379717`*^9}, {
  3.7013431368314867`*^9, 3.701343142746623*^9}, {3.7013431807398033`*^9, 
  3.701343211646037*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"f$slope$fssd", "[", 
   RowBox[{"v", ",", 
    SubscriptBox["\[Mu]", "q"], ",", 
    SuperscriptBox[
     SubscriptBox["\[Sigma]", "q"], "2"], ",", 
    SuperscriptBox[
     SubscriptBox["\[Sigma]", "k"], "2"]}], "]"}], " ", "//", " ", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.7013345138681087`*^9, 3.701334558487569*^9}, {
  3.701334611750679*^9, 3.70133461438769*^9}}],

Cell[BoxData[
 RowBox[{"f$slope$fssd", "[", 
  RowBox[{"v", ",", "0", ",", 
   SuperscriptBox[
    SubscriptBox["\[Sigma]", "q"], "2"], ",", 
   SuperscriptBox[
    SubscriptBox["\[Sigma]", "k"], "2"]}], "]"}]], "Input",
 CellChangeTimes->{{3.7013349829151783`*^9, 3.7013350032827997`*^9}}],

Cell[BoxData[
 RowBox[{"f$slope$fssd", "[", 
  RowBox[{"v", ",", 
   SubscriptBox["\[Mu]", "q"], ",", "1", ",", 
   SuperscriptBox[
    SubscriptBox["\[Sigma]", "k"], "2"]}], "]"}]], "Input",
 CellChangeTimes->{{3.701335020857169*^9, 3.701335026419756*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.701335011879348*^9, 3.7013350128697233`*^9}}],

Cell["Ratio of two Gaussian densities\[LineSeparator]", "Text",
 CellChangeTimes->{{3.7012547597167587`*^9, 3.701254766053817*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"r", "[", 
    RowBox[{"x_", ",", "mr_", ",", "sr_"}], "]"}], ":=", 
   RowBox[{"Exp", "[", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"x", "-", "mr"}], ")"}], "^", "2"}]}], "/", 
     RowBox[{"(", 
      RowBox[{"2", "*", "sr"}], ")"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s", "[", 
   RowBox[{"x_", ",", "ms_", ",", "ss_"}], "]"}], ":=", 
  RowBox[{"Exp", "[", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"x", "-", "ms"}], ")"}], "^", "2"}]}], "/", 
    RowBox[{"(", 
     RowBox[{"2", "*", "ss"}], ")"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{
  3.701254773653605*^9, {3.701254832878454*^9, 3.701254900677499*^9}, {
   3.701256267583651*^9, 3.7012562697240353`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"r", "[", 
   RowBox[{"x", ",", "0", ",", "sr"}], "]"}], "/", 
  RowBox[{"s", "[", 
   RowBox[{"x", ",", "0", ",", " ", "1"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.701256278012884*^9, 3.7012562803483963`*^9}, {
  3.701257010943334*^9, 3.701257017852482*^9}}],

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"r", "[", 
       RowBox[{"x", ",", "0", ",", "sr"}], "]"}], "/", 
      RowBox[{"s", "[", 
       RowBox[{"x", ",", "0", ",", " ", "1"}], "]"}]}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"x", ",", " ", 
       RowBox[{"-", "10"}], ",", " ", "10"}], "}"}]}], "]"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"sr", ",", " ", "0.1"}], "}"}], ",", " ", "0.1", ",", " ", "5", 
     ",", "0.1"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7012548846429033`*^9, 3.701254997701292*^9}, {
   3.701255037651504*^9, 3.701255116537476*^9}, {3.701255156862811*^9, 
   3.701255179761894*^9}, {3.7012552301371593`*^9, 3.701255279135871*^9}, 
   3.701255376424*^9, {3.701256287274576*^9, 3.701256292273478*^9}, 
   3.7012563514491673`*^9, {3.70125639244807*^9, 3.701256406436051*^9}, {
   3.701257004490926*^9, 3.701257033827482*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Zero-mean Gaussian case", "Section",
 CellChangeTimes->{{3.701772660305811*^9, 3.7017726659680357`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"f$slope$fssd$mq0", "[", 
   RowBox[{"v1_", ",", "sq1_", ",", "sk1_"}], "]"}], ":=", 
  RowBox[{"f$slope$fssd", "[", 
   RowBox[{"v1", ",", "0", ",", "sq1", ",", "sk1"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7017726713474503`*^9, 3.7017726804432993`*^9}, {
  3.701772712905498*^9, 3.701772756205001*^9}, {3.7017728129684353`*^9, 
  3.701772856903963*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"f$slope$fssd$mq0", "[", 
   RowBox[{"v", ",", 
    SuperscriptBox[
     SubscriptBox["\[Sigma]", "q"], "2"], ",", 
    SuperscriptBox[
     SubscriptBox["\[Sigma]", "k"], "2"]}], "]"}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.701772758080846*^9, 3.701772773192453*^9}, {
   3.70177290282999*^9, 3.7017729031421213`*^9}, {3.701773037786838*^9, 
   3.701773040974334*^9}, {3.701944455136115*^9, 3.701944456659482*^9}, 
   3.701945430110571*^9, {3.701945525567436*^9, 3.7019455270053*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"f$slope$fssd$mq0", "[", 
   RowBox[{
    SubscriptBox["\[Sigma]", "q"], ",", 
    SuperscriptBox[
     SubscriptBox["\[Sigma]", "q"], "2"], ",", 
    SuperscriptBox[
     SubscriptBox["\[Sigma]", "q"], "2"]}], "]"}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.7019451687115793`*^9, 3.701945201271058*^9}, {
  3.701945324970756*^9, 3.701945355134058*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"f$slope$fssd$mq0", "[", 
   RowBox[{"v", ",", 
    SuperscriptBox[
     SubscriptBox["\[Sigma]", "q"], "2"], ",", "1"}], "]"}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{
  3.701772985685491*^9, {3.701773048299987*^9, 3.701773140326913*^9}, {
   3.701773179140724*^9, 3.701773192116131*^9}, {3.701773223503751*^9, 
   3.701773225516296*^9}, {3.7017733457311087`*^9, 3.701773360068307*^9}, {
   3.7017733921445017`*^9, 3.701773409306314*^9}, {3.701780558842121*^9, 
   3.701780560166984*^9}, 3.701780694943495*^9, 3.701780855773*^9, 
   3.7017812971837597`*^9, {3.701781331259206*^9, 3.701781369133039*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"f$slope$fssd$mq0", "[", 
   RowBox[{
    SubscriptBox["\[Sigma]", "q"], ",", 
    SuperscriptBox[
     SubscriptBox["\[Sigma]", "q"], "2"], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"Boole", "[", 
       RowBox[{
        SubscriptBox["\[Sigma]", "q"], "<", "1"}], "]"}], 
      SuperscriptBox[
       SubscriptBox["\[Sigma]", "q"], "2"]}], "+", 
     RowBox[{"Boole", "[", 
      RowBox[{
       SubscriptBox["\[Sigma]", "q"], "\[GreaterEqual]", " ", "1"}], 
      "]"}]}]}], " ", "]"}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.701938199852315*^9, 3.701938207026038*^9}, {
  3.701938320451652*^9, 3.7019383329623833`*^9}, {3.701942421853284*^9, 
  3.701942519064191*^9}, {3.702901452676539*^9, 3.7029014528748913`*^9}}],

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"Plot3D", "[", 
    RowBox[{
     RowBox[{"f$slope$fssd$mq0", "[", 
      RowBox[{"v", ",", 
       SuperscriptBox["sq", "2"], ",", 
       SuperscriptBox["sk", "2"]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"v", ",", "0.01", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"sk", ",", "0.01", ",", "3"}], "}"}], ",", 
     RowBox[{"AxesLabel", "\[Rule]", "Automatic"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"sq", ",", "0.01", ",", "3"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7019377917925463`*^9, 3.70193786026311*^9}, {
  3.701937917855752*^9, 3.701937947766865*^9}, {3.701939949770832*^9, 
  3.7019399586806087`*^9}, {3.701940449540141*^9, 3.701940453587422*^9}, {
  3.701940758959553*^9, 3.70194077245923*^9}, {3.701941613951499*^9, 
  3.701941635712812*^9}, {3.701942081733714*^9, 3.701942086557385*^9}, {
  3.701942304168498*^9, 3.701942305892476*^9}}],

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"NMaximize", "[", 
    RowBox[{
     RowBox[{"f$slope$fssd$mq0", "[", 
      RowBox[{"v", ",", 
       SuperscriptBox["sq", "2"], ",", 
       SuperscriptBox["sk", "2"]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"v", ",", "sk"}], "}"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"sq", ",", "0.01", ",", "3"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.701942781199276*^9, 3.7019428865030737`*^9}, {
  3.701942997439535*^9, 3.701943001571944*^9}}],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"f$slope$fssd$mq0", "[", 
      RowBox[{
       SubscriptBox["\[Sigma]", "q"], ",", 
       SuperscriptBox[
        SubscriptBox["\[Sigma]", "q"], "2"], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"Boole", "[", 
          RowBox[{
           SubscriptBox["\[Sigma]", "q"], "<", "1"}], "]"}], 
         SuperscriptBox[
          SubscriptBox["\[Sigma]", "q"], "2"]}], "+", 
        RowBox[{"Boole", "[", 
         RowBox[{
          SubscriptBox["\[Sigma]", "q"], "\[GreaterEqual]", " ", "1"}], 
         "]"}]}]}], " ", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"f$slope$fssd$mq0", "[", 
      RowBox[{
       SubscriptBox["\[Sigma]", "q"], ",", 
       SuperscriptBox[
        SubscriptBox["\[Sigma]", "q"], "2"], ",", 
       SuperscriptBox[
        SubscriptBox["\[Sigma]", "q"], "2"]}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["\[Sigma]", "q"], ",", "0", ",", "3"}], "}"}], ",", 
   RowBox[{"GridLines", "\[Rule]", "Automatic"}], ",", 
   RowBox[{"PlotLegends", "\[Rule]", "Automatic"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7017734404091454`*^9, 3.70177347084583*^9}, 
   3.701780037968712*^9, {3.701780104118759*^9, 3.7017801400051126`*^9}, {
   3.701780205933518*^9, 3.701780254192376*^9}, 3.701781399751288*^9, {
   3.701781490185639*^9, 3.701781538257823*^9}, {3.701938265678616*^9, 
   3.701938289338151*^9}, {3.701938342414678*^9, 3.701938398988226*^9}, {
   3.701940980922076*^9, 3.70194098144442*^9}, {3.701942003784131*^9, 
   3.7019420145831547`*^9}, 3.70194227828185*^9, {3.701942320706595*^9, 
   3.701942324954399*^9}, {3.701942530003208*^9, 3.701942539314661*^9}, {
   3.7019425793537197`*^9, 3.701942583271583*^9}, {3.701942626027688*^9, 
   3.70194263218793*^9}, {3.702901646349544*^9, 3.702901696297488*^9}, {
   3.70290176265939*^9, 3.702901886520533*^9}},
 NumberMarks->False],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.702901768955065*^9, 3.702901773183177*^9}}],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"f$slope$fssd$mq0", "[", 
    RowBox[{
     SubscriptBox["\[Sigma]", "q"], ",", 
     SuperscriptBox[
      SubscriptBox["\[Sigma]", "q"], "2"], ",", 
     SuperscriptBox[
      SubscriptBox["\[Sigma]", "q"], "2"]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["\[Sigma]", "q"], ",", "0", ",", "2"}], "}"}], ",", 
   RowBox[{"GridLines", "\[Rule]", "Automatic"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.701942561951993*^9, 3.701942592843852*^9}, {
  3.7019434160810328`*^9, 3.7019436012170353`*^9}, {3.701943781977208*^9, 
  3.701943782824683*^9}, {3.701943881325178*^9, 3.701943881836709*^9}, {
  3.702901631036467*^9, 3.7029016320228987`*^9}}],

Cell[BoxData[
 RowBox[{"f$vxip", "[", 
  RowBox[{"v", ",", 
   SuperscriptBox[
    SubscriptBox["\[Sigma]", "q"], "2"], ",", 
   SuperscriptBox[
    SubscriptBox["\[Sigma]", "k"], "2"]}], "]"}]], "Input",
 CellChangeTimes->{{3.701939814494646*^9, 3.7019398234198112`*^9}}],

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"Plot3D", "[", 
    RowBox[{
     RowBox[{"f$vxip", "[", 
      RowBox[{"v", ",", 
       SuperscriptBox["sq", "2"], ",", 
       SuperscriptBox["sk", "2"]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"v", ",", "0.01", ",", "5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"sk", ",", "0.01", ",", "5"}], "}"}], ",", 
     RowBox[{"AxesLabel", "\[Rule]", "Automatic"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"sq", ",", "0.01", ",", "5"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.701939913308827*^9, 3.701939913899249*^9}, {
  3.7019399694816217`*^9, 3.7019399753181543`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"f$slope$fssd$mq0", "[", 
   RowBox[{"v", ",", 
    SuperscriptBox[
     SubscriptBox["\[Sigma]", "q"], "2"], ",", 
    SuperscriptBox[
     SubscriptBox["\[Sigma]", "k"], 
     RowBox[{"2", " "}]]}], "]"}], "/", 
  RowBox[{"f$slope$lkstein$mq0", "[", 
   RowBox[{
    SuperscriptBox[
     SubscriptBox["\[Sigma]", "q"], "2"], ",", 
    SuperscriptBox["\[Kappa]", "2"]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.701778946904253*^9, 3.701778994005621*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Best parameters in the unit-variance case", "Section",
 CellChangeTimes->{{3.7016187863301687`*^9, 3.701618792824279*^9}, {
  3.701618823112299*^9, 3.701618825974455*^9}, {3.701618979285277*^9, 
  3.7016189844095697`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"f$slope$fssd$sq1", "[", 
   RowBox[{"v1_", ",", "mq1_", ",", "sk1_"}], "]"}], ":=", 
  RowBox[{"f$slope$fssd", "[", 
   RowBox[{"v1", ",", "mq1", ",", "1", ",", "sk1"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.701618746335952*^9, 3.7016187770875187`*^9}, {
  3.7016188755250177`*^9, 3.701618915523324*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"f$slope$fssd$sq1", "[", 
   RowBox[{"v", ",", 
    SubscriptBox["\[Mu]", "q"], ",", 
    SuperscriptBox[
     SubscriptBox["\[Sigma]", "k"], "2"]}], "]"}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.701618919504887*^9, 3.701618934298463*^9}, {
  3.701666034335614*^9, 3.701666039734407*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.701619046734749*^9},
 NumberMarks->False],

Cell[BoxData[
 RowBox[{"f$slope$fssd$sq1", "[", 
  RowBox[{
   SubscriptBox["\[Mu]", "q"], ",", 
   SubscriptBox["\[Mu]", "q"], ",", 
   SuperscriptBox[
    SubscriptBox["\[Sigma]", "k"], "2"]}], "]"}]], "Input",
 CellChangeTimes->{{3.701619062898876*^9, 3.7016190714348783`*^9}, {
  3.701619314119876*^9, 3.701619315231194*^9}, {3.701619350807452*^9, 
  3.701619352205635*^9}, {3.701619684278245*^9, 3.701619684502017*^9}, {
  3.7016198601757917`*^9, 3.701619872537096*^9}, {3.7016665804155197`*^9, 
  3.701666580740828*^9}}],

Cell[BoxData[
 RowBox[{"f$slope$fssd$sq1", "[", 
  RowBox[{
   SubscriptBox["\[Mu]", "q"], ",", 
   SubscriptBox["\[Mu]", "q"], ",", "1"}], "]"}]], "Input",
 CellChangeTimes->{{3.701619879386388*^9, 3.7016199045489883`*^9}, {
  3.7016199578117533`*^9, 3.7016199838113403`*^9}}],

Cell[BoxData[
 RowBox[{"Reduce", "[", 
  RowBox[{
   RowBox[{"f$slope$fssd$sq1", "[", 
    RowBox[{
     SubscriptBox["\[Mu]", "q"], ",", 
     SubscriptBox["\[Mu]", "q"], ",", "1"}], "]"}], ">", 
   "slope$lkstein$sq1$lim"}], "]"}]], "Input",
 CellChangeTimes->{{3.701666231405163*^9, 3.7016662483068867`*^9}, {
  3.701666486492898*^9, 3.7016664906915903`*^9}, {3.701666556728201*^9, 
  3.701666598265263*^9}, {3.702572637233109*^9, 3.702572639721314*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"f$slope$fssd$sq1", "[", 
    RowBox[{
     SubscriptBox["\[Mu]", "q"], ",", 
     SubscriptBox["\[Mu]", "q"], ",", "1"}], "]"}], "/", 
   "slope$lkstein$sq1$lim"}], " ", "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.701666757679942*^9, 3.70166676615282*^9}, {
  3.7016668476875362`*^9, 3.701666898661378*^9}, {3.701666965698709*^9, 
  3.7016669864981327`*^9}, {3.701667177571316*^9, 3.701667195131796*^9}, {
  3.701667225257979*^9, 3.701667256263489*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"f$slope$fssd$sq1", "[", 
   RowBox[{
    SubscriptBox["\[Mu]", "q"], ",", 
    SubscriptBox["\[Mu]", "q"], ",", "1"}], "]"}], "-", 
  "slope$lkstein$sq1$lim", " "}]], "Input",
 CellChangeTimes->{{3.701667635240049*^9, 3.701667656290566*^9}, {
  3.701668630258453*^9, 3.701668639915401*^9}, {3.701668684741057*^9, 
  3.701668708627369*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"9", " ", 
    SqrtBox["3"], " ", 
    SuperscriptBox["\[ExponentialE]", 
     FractionBox[
      SubsuperscriptBox["\[Mu]", "q", "2"], "3"]], " ", 
    SubsuperscriptBox["\[Mu]", "q", "2"]}], 
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{"12", "+", 
      SubsuperscriptBox["\[Mu]", "q", "2"]}], ")"}]}]], "-", 
  FractionBox[
   SubsuperscriptBox["\[Mu]", "q", "4"], 
   RowBox[{"2", "+", 
    RowBox[{"4", " ", 
     SubsuperscriptBox["\[Mu]", "q", "2"]}]}]]}]], "Input"],

Cell[BoxData[
 RowBox[{"Plot3D", "[", 
  RowBox[{
   RowBox[{"f$slope$fssd$sq1", "[", 
    RowBox[{
     SubscriptBox["\[Mu]", "q"], ",", 
     SubscriptBox["\[Mu]", "q"], ",", 
     SuperscriptBox[
      SubscriptBox["\[Sigma]", "k"], "2"]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["\[Mu]", "q"], ",", "0.001", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["\[Sigma]", "k"], ",", "0.001", ",", "20"}], "}"}], ",", 
   RowBox[{"AxesLabel", "\[Rule]", "Automatic"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.701619268423295*^9, 3.701619292698369*^9}, {
   3.701619324572748*^9, 3.70161932524303*^9}, {3.701619356583981*^9, 
   3.701619368936872*^9}, {3.701619650908532*^9, 3.701619653151944*^9}, {
   3.701619690868438*^9, 3.701619781338244*^9}, 3.701619832858819*^9},
 NumberMarks->False]
}, Open  ]]
},
WindowSize->{1076, 1896},
WindowMargins->{{Automatic, 4}, {4, Automatic}},
Magnification:>1.25 Inherited,
FrontEndVersion->"10.2 for Linux x86 (64-bit) (July 29, 2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 102, 1, 81, "Section"],
Cell[685, 25, 128, 1, 40, "Text"],
Cell[816, 28, 1614, 52, 196, "Input"],
Cell[2433, 82, 672, 18, 44, "Input"],
Cell[3108, 102, 222, 5, 38, "Input"],
Cell[3333, 109, 514, 13, 38, "Input"],
Cell[3850, 124, 241, 6, 38, "Input"],
Cell[4094, 132, 241, 7, 38, "Input"],
Cell[4338, 141, 307, 7, 38, "Input"],
Cell[4648, 150, 696, 19, 38, "Input"],
Cell[5347, 171, 218, 4, 38, "Input"],
Cell[5568, 177, 516, 14, 38, "Input"],
Cell[6087, 193, 397, 10, 38, "Input"],
Cell[6487, 205, 553, 9, 38, "Input"],
Cell[7043, 216, 717, 18, 64, "Input"],
Cell[7763, 236, 413, 11, 44, "Input"],
Cell[8179, 249, 290, 7, 44, "Input"],
Cell[8472, 258, 257, 6, 44, "Input"],
Cell[8732, 266, 94, 1, 38, "Input"],
Cell[8829, 269, 131, 1, 67, "Text"],
Cell[8963, 272, 827, 27, 64, "Input"],
Cell[9793, 301, 296, 7, 38, "Input"],
Cell[10092, 310, 981, 23, 38, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11110, 338, 110, 1, 81, "Section"],
Cell[11223, 341, 393, 8, 38, "Input"],
Cell[11619, 351, 536, 12, 44, "Input"],
Cell[12158, 365, 401, 11, 44, "Input"],
Cell[12562, 378, 651, 13, 44, "Input"],
Cell[13216, 393, 771, 20, 44, "Input"],
Cell[13990, 415, 957, 21, 74, "Input"],
Cell[14950, 438, 525, 14, 44, "Input"],
Cell[15478, 454, 1944, 44, 104, "Input"],
Cell[17425, 500, 92, 1, 38, "Input"],
Cell[17520, 503, 723, 17, 44, "Input"],
Cell[18246, 522, 272, 7, 44, "Input"],
Cell[18521, 531, 661, 17, 74, "Input"],
Cell[19185, 550, 490, 14, 56, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19712, 569, 228, 3, 101, "Section"],
Cell[19943, 574, 342, 7, 47, "Input"],
Cell[20288, 583, 338, 9, 55, "Input"],
Cell[20629, 594, 89, 2, 47, "Input"],
Cell[20721, 598, 526, 11, 55, "Input"],
Cell[21250, 611, 277, 6, 47, "Input"],
Cell[21530, 619, 457, 10, 47, "Input"],
Cell[21990, 631, 508, 11, 47, "Input"],
Cell[22501, 644, 374, 9, 47, "Input"],
Cell[22878, 655, 532, 17, 127, "Input"],
Cell[23413, 674, 837, 20, 92, "Input"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
